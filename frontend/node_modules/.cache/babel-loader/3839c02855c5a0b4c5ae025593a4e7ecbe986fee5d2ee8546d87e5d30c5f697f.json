{"ast":null,"code":"import React,{useEffect,useMemo,useState}from'react';import axios from'axios';import'../styles/Contacts.css';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";function Contacts(_ref){let{refreshToken=0}=_ref;const[recentContacts,setRecentContacts]=useState([]);const[contacts,setContacts]=useState([]);const[selectedContact,setSelectedContact]=useState(null);const[selectedConversations,setSelectedConversations]=useState([]);const[gmailSuggestions,setGmailSuggestions]=useState([]);const[selectedSuggestionEmails,setSelectedSuggestionEmails]=useState([]);const[scanWindowDays,setScanWindowDays]=useState(45);const[scanMaxMessages,setScanMaxMessages]=useState(50);const[scanSource,setScanSource]=useState('');const[scanWarning,setScanWarning]=useState('');const[search,setSearch]=useState('');const[loading,setLoading]=useState(true);const[loadingDetails,setLoadingDetails]=useState(false);const[scanningSuggestions,setScanningSuggestions]=useState(false);const[applyingSuggestions,setApplyingSuggestions]=useState(false);const[mergingSummaries,setMergingSummaries]=useState(false);const[gmailConnected,setGmailConnected]=useState(null);const loadGmailStatus=async()=>{try{var _res$data$connected,_res$data;const res=await axios.get('/api/auth/gmail/status');setGmailConnected((_res$data$connected=(_res$data=res.data)===null||_res$data===void 0?void 0:_res$data.connected)!==null&&_res$data$connected!==void 0?_res$data$connected:false);}catch(_){setGmailConnected(false);}};const loadContacts=async function(){let searchValue=arguments.length>0&&arguments[0]!==undefined?arguments[0]:'';const[recentRes,listRes]=await Promise.all([axios.get('/api/contacts/recent',{params:{limit:12}}),axios.get('/api/contacts',{params:{search:searchValue,limit:150}})]);setRecentContacts(recentRes.data||[]);setContacts(listRes.data||[]);};const loadContactDetails=async contactId=>{setLoadingDetails(true);try{var _response$data;const response=await axios.get(\"/api/contacts/\".concat(contactId));setSelectedContact(response.data||null);setSelectedConversations(((_response$data=response.data)===null||_response$data===void 0?void 0:_response$data.conversations)||[]);}catch(error){var _error$response,_error$response$data;console.error('Error loading contact details:',error);alert(((_error$response=error.response)===null||_error$response===void 0?void 0:(_error$response$data=_error$response.data)===null||_error$response$data===void 0?void 0:_error$response$data.error)||'Unable to load contact details right now');}finally{setLoadingDetails(false);}};useEffect(()=>{let isMounted=true;setLoading(true);loadGmailStatus();loadContacts(search).catch(error=>{var _error$response2,_error$response2$data;console.error('Error loading contacts:',error);if(isMounted)alert(((_error$response2=error.response)===null||_error$response2===void 0?void 0:(_error$response2$data=_error$response2.data)===null||_error$response2$data===void 0?void 0:_error$response2$data.error)||'Unable to load contacts right now');}).finally(()=>{if(isMounted)setLoading(false);});return()=>{isMounted=false;};// eslint-disable-next-line react-hooks/exhaustive-deps\n},[refreshToken]);const searchCountLabel=useMemo(()=>{if(!search.trim())return\"\".concat(contacts.length,\" contacts\");return\"\".concat(contacts.length,\" results\");},[contacts.length,search]);const handleSearch=async()=>{try{setLoading(true);await loadContacts(search);}catch(error){var _error$response3,_error$response3$data;console.error('Error searching contacts:',error);alert(((_error$response3=error.response)===null||_error$response3===void 0?void 0:(_error$response3$data=_error$response3.data)===null||_error$response3$data===void 0?void 0:_error$response3$data.error)||'Unable to search contacts right now');}finally{setLoading(false);}};const scanGmailSuggestions=async()=>{setScanningSuggestions(true);setScanWarning('');try{var _response$data2,_response$data3,_response$data4;const response=await axios.post('/api/contacts/suggestions/from-live-gmail',{scan_window_days:scanWindowDays,max_messages:scanMaxMessages});const suggestions=((_response$data2=response.data)===null||_response$data2===void 0?void 0:_response$data2.suggestions)||[];setGmailSuggestions(suggestions);setSelectedSuggestionEmails(suggestions.map(item=>item.email).filter(Boolean));setScanSource(((_response$data3=response.data)===null||_response$data3===void 0?void 0:_response$data3.source)||'');setScanWarning(((_response$data4=response.data)===null||_response$data4===void 0?void 0:_response$data4.warning)||'');}catch(error){var _error$response4,_error$response4$data;console.error('Error scanning Gmail suggestions:',error);alert(((_error$response4=error.response)===null||_error$response4===void 0?void 0:(_error$response4$data=_error$response4.data)===null||_error$response4$data===void 0?void 0:_error$response4$data.error)||'Unable to scan Gmail suggestions right now');}finally{setScanningSuggestions(false);}};const toggleSuggestion=email=>{if(!email)return;setSelectedSuggestionEmails(prev=>{if(prev.includes(email))return prev.filter(item=>item!==email);return[...prev,email];});};const applySelectedSuggestions=async()=>{const selected=gmailSuggestions.filter(item=>selectedSuggestionEmails.includes(item.email));if(!selected.length){alert('Select at least one suggestion to apply.');return;}setApplyingSuggestions(true);try{var _response$data5,_response$data6;const response=await axios.post('/api/contacts/suggestions/apply',{suggestions:selected});alert(\"Suggestions applied. Created: \".concat(((_response$data5=response.data)===null||_response$data5===void 0?void 0:_response$data5.created_count)||0,\", Updated: \").concat(((_response$data6=response.data)===null||_response$data6===void 0?void 0:_response$data6.updated_count)||0));await loadContacts(search);setGmailSuggestions([]);setSelectedSuggestionEmails([]);}catch(error){var _error$response5,_error$response5$data;console.error('Error applying suggestions:',error);alert(((_error$response5=error.response)===null||_error$response5===void 0?void 0:(_error$response5$data=_error$response5.data)===null||_error$response5$data===void 0?void 0:_error$response5$data.error)||'Unable to apply suggestions right now');}finally{setApplyingSuggestions(false);}};const mergeRecentSummaries=async()=>{setMergingSummaries(true);try{var _response$data7;const response=await axios.post('/api/contacts/merge-recent-summaries',{days:30});alert(\"Merged recent conversation summaries for \".concat(((_response$data7=response.data)===null||_response$data7===void 0?void 0:_response$data7.merged_count)||0,\" contact(s).\"));await loadContacts(search);if(selectedContact!==null&&selectedContact!==void 0&&selectedContact.id){await loadContactDetails(selectedContact.id);}}catch(error){var _error$response6,_error$response6$data;console.error('Error merging recent summaries:',error);alert(((_error$response6=error.response)===null||_error$response6===void 0?void 0:(_error$response6$data=_error$response6.data)===null||_error$response6$data===void 0?void 0:_error$response6$data.error)||'Unable to merge recent summaries right now');}finally{setMergingSummaries(false);}};if(loading){return/*#__PURE__*/_jsxs(\"div\",{className:\"card\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"\\uD83D\\uDC65 Contacts\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Loading contacts...\"})]});}return/*#__PURE__*/_jsxs(\"div\",{className:\"contacts-layout\",children:[/*#__PURE__*/_jsxs(\"section\",{className:\"card\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"\\uD83E\\uDD16 Gmail Suggestions\"}),/*#__PURE__*/_jsx(\"p\",{className:\"section-subtext\",children:\"Scan Gmail with ChatGPT and review suggestions before adding or updating contacts.\"}),gmailConnected===false&&/*#__PURE__*/_jsxs(\"div\",{className:\"gmail-notice gmail-notice--warn\",children:[\"Gmail not connected. Go to \",/*#__PURE__*/_jsx(\"strong\",{children:\"Settings \\u2192 Gmail Account Connection\"}),\" to link your Google account before scanning.\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"contacts-actions-row\",children:[/*#__PURE__*/_jsxs(\"label\",{children:[\"Window (days)\",/*#__PURE__*/_jsx(\"input\",{type:\"number\",min:1,max:365,value:scanWindowDays,onChange:e=>setScanWindowDays(Math.max(parseInt(e.target.value,10)||1,1))})]}),/*#__PURE__*/_jsxs(\"label\",{children:[\"Max messages\",/*#__PURE__*/_jsx(\"input\",{type:\"number\",min:5,max:100,value:scanMaxMessages,onChange:e=>setScanMaxMessages(Math.max(Math.min(parseInt(e.target.value,10)||50,100),5))})]}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-primary btn-small\",type:\"button\",onClick:scanGmailSuggestions,disabled:scanningSuggestions||gmailConnected===false,children:scanningSuggestions?'Scanning...':'Scan Gmail'}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-secondary btn-small\",type:\"button\",onClick:applySelectedSuggestions,disabled:applyingSuggestions||selectedSuggestionEmails.length===0,children:applyingSuggestions?'Applying...':\"Apply Selected (\".concat(selectedSuggestionEmails.length,\")\")}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-secondary btn-small\",type:\"button\",onClick:mergeRecentSummaries,disabled:mergingSummaries,children:mergingSummaries?'Merging...':'Merge Recent Summaries'})]}),scanSource?/*#__PURE__*/_jsxs(\"p\",{className:\"section-subtext\",children:[\"Scan source: \",scanSource]}):null,scanWarning?/*#__PURE__*/_jsx(\"p\",{className:\"error-text\",children:scanWarning}):null,gmailSuggestions.length>0?/*#__PURE__*/_jsxs(\"table\",{className:\"data-table contacts-table\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"Add\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Name\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Email\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Action\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Reason\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Summary\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:gmailSuggestions.map(item=>/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:selectedSuggestionEmails.includes(item.email),onChange:()=>toggleSuggestion(item.email)})}),/*#__PURE__*/_jsx(\"td\",{children:item.full_name||'-'}),/*#__PURE__*/_jsx(\"td\",{children:item.email||'-'}),/*#__PURE__*/_jsx(\"td\",{children:item.action==='update'?\"Update (\".concat(item.existing_contact_name||'existing',\")\"):'Create'}),/*#__PURE__*/_jsx(\"td\",{children:item.reason||'-'}),/*#__PURE__*/_jsx(\"td\",{children:item.conversation_summary||'-'})]},\"\".concat(item.email,\"_\").concat(item.thread_id||'')))})]}):/*#__PURE__*/_jsx(\"p\",{className:\"empty-state\",children:\"No suggestions loaded yet. Run a Gmail scan.\"})]}),/*#__PURE__*/_jsxs(\"section\",{className:\"card\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"\\uD83D\\uDD52 Recent Contacts\"}),/*#__PURE__*/_jsx(\"p\",{className:\"section-subtext\",children:\"Most recently touched contacts and their latest interaction context.\"}),recentContacts.length>0?/*#__PURE__*/_jsxs(\"table\",{className:\"data-table contacts-table\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"Contact\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Email\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Last Interaction\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Recent Context\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:recentContacts.map(contact=>{const latest=(contact.recent_interactions||[])[0]||null;return/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:contact.full_name||'-'}),/*#__PURE__*/_jsx(\"td\",{children:contact.email||'-'}),/*#__PURE__*/_jsx(\"td\",{children:contact.last_conversation_at||contact.last_contacted_at||'-'}),/*#__PURE__*/_jsx(\"td\",{children:(latest===null||latest===void 0?void 0:latest.summary)||contact.conversation_summary||'-'})]},contact.id);})})]}):/*#__PURE__*/_jsx(\"p\",{className:\"empty-state\",children:\"No recent contacts yet.\"})]}),/*#__PURE__*/_jsxs(\"section\",{className:\"card\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"contacts-toolbar\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"All Contacts\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"contacts-search\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:search,onChange:e=>setSearch(e.target.value),placeholder:\"Search name, email, company, notes\",onKeyDown:e=>{if(e.key==='Enter')handleSearch();}}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-primary btn-small\",type:\"button\",onClick:handleSearch,children:\"Search\"})]})]}),/*#__PURE__*/_jsx(\"p\",{className:\"section-subtext\",children:searchCountLabel}),/*#__PURE__*/_jsxs(\"div\",{className:\"contacts-grid\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"contacts-list\",children:contacts.length>0?/*#__PURE__*/_jsxs(\"table\",{className:\"data-table contacts-table\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"Name\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Email\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Status\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Source\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Updated\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:contacts.map(contact=>/*#__PURE__*/_jsxs(\"tr\",{className:(selectedContact===null||selectedContact===void 0?void 0:selectedContact.id)===contact.id?'row-selected':'',children:[/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"button\",{className:\"link-btn\",type:\"button\",onClick:()=>loadContactDetails(contact.id),children:contact.full_name||'(No name)'})}),/*#__PURE__*/_jsx(\"td\",{children:contact.email||'-'}),/*#__PURE__*/_jsx(\"td\",{children:contact.status||'-'}),/*#__PURE__*/_jsx(\"td\",{children:contact.contact_source||'-'}),/*#__PURE__*/_jsx(\"td\",{children:contact.updated_at||'-'})]},contact.id))})]}):/*#__PURE__*/_jsx(\"p\",{className:\"empty-state\",children:\"No contacts found.\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"contacts-details\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Conversation Detail\"}),loadingDetails?/*#__PURE__*/_jsx(\"p\",{children:\"Loading contact details...\"}):selectedContact?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"contact-meta\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Name:\"}),\" \",selectedContact.full_name||'-']}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Email:\"}),\" \",selectedContact.email||'-']}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Status:\"}),\" \",selectedContact.status||'-']}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Source:\"}),\" \",selectedContact.contact_source||'-']})]}),/*#__PURE__*/_jsx(\"div\",{className:\"conversation-list\",children:selectedConversations.length>0?selectedConversations.map(item=>/*#__PURE__*/_jsxs(\"div\",{className:\"conversation-item\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"conversation-head\",children:[/*#__PURE__*/_jsx(\"strong\",{children:item.subject||'No subject'}),/*#__PURE__*/_jsx(\"span\",{children:item.occurred_at||item.created_at||'-'})]}),/*#__PURE__*/_jsx(\"p\",{children:item.summary})]},item.id)):/*#__PURE__*/_jsx(\"p\",{children:\"No conversation history yet.\"})})]}):/*#__PURE__*/_jsx(\"p\",{children:\"Select a contact to view interaction history.\"})]})]})]})]});}export default Contacts;","map":{"version":3,"names":["React","useEffect","useMemo","useState","axios","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","Contacts","_ref","refreshToken","recentContacts","setRecentContacts","contacts","setContacts","selectedContact","setSelectedContact","selectedConversations","setSelectedConversations","gmailSuggestions","setGmailSuggestions","selectedSuggestionEmails","setSelectedSuggestionEmails","scanWindowDays","setScanWindowDays","scanMaxMessages","setScanMaxMessages","scanSource","setScanSource","scanWarning","setScanWarning","search","setSearch","loading","setLoading","loadingDetails","setLoadingDetails","scanningSuggestions","setScanningSuggestions","applyingSuggestions","setApplyingSuggestions","mergingSummaries","setMergingSummaries","gmailConnected","setGmailConnected","loadGmailStatus","_res$data$connected","_res$data","res","get","data","connected","_","loadContacts","searchValue","arguments","length","undefined","recentRes","listRes","Promise","all","params","limit","loadContactDetails","contactId","_response$data","response","concat","conversations","error","_error$response","_error$response$data","console","alert","isMounted","catch","_error$response2","_error$response2$data","finally","searchCountLabel","trim","handleSearch","_error$response3","_error$response3$data","scanGmailSuggestions","_response$data2","_response$data3","_response$data4","post","scan_window_days","max_messages","suggestions","map","item","email","filter","Boolean","source","warning","_error$response4","_error$response4$data","toggleSuggestion","prev","includes","applySelectedSuggestions","selected","_response$data5","_response$data6","created_count","updated_count","_error$response5","_error$response5$data","mergeRecentSummaries","_response$data7","days","merged_count","id","_error$response6","_error$response6$data","className","children","type","min","max","value","onChange","e","Math","parseInt","target","onClick","disabled","checked","full_name","action","existing_contact_name","reason","conversation_summary","thread_id","contact","latest","recent_interactions","last_conversation_at","last_contacted_at","summary","placeholder","onKeyDown","key","status","contact_source","updated_at","subject","occurred_at","created_at"],"sources":["/home/rob/.openclaw/workspace/campsite-crm/frontend/src/components/Contacts.jsx"],"sourcesContent":["import React, { useEffect, useMemo, useState } from 'react';\nimport axios from 'axios';\nimport '../styles/Contacts.css';\n\nfunction Contacts({ refreshToken = 0 }) {\n  const [recentContacts, setRecentContacts] = useState([]);\n  const [contacts, setContacts] = useState([]);\n  const [selectedContact, setSelectedContact] = useState(null);\n  const [selectedConversations, setSelectedConversations] = useState([]);\n  const [gmailSuggestions, setGmailSuggestions] = useState([]);\n  const [selectedSuggestionEmails, setSelectedSuggestionEmails] = useState([]);\n  const [scanWindowDays, setScanWindowDays] = useState(45);\n  const [scanMaxMessages, setScanMaxMessages] = useState(50);\n  const [scanSource, setScanSource] = useState('');\n  const [scanWarning, setScanWarning] = useState('');\n  const [search, setSearch] = useState('');\n  const [loading, setLoading] = useState(true);\n  const [loadingDetails, setLoadingDetails] = useState(false);\n  const [scanningSuggestions, setScanningSuggestions] = useState(false);\n  const [applyingSuggestions, setApplyingSuggestions] = useState(false);\n  const [mergingSummaries, setMergingSummaries] = useState(false);\n  const [gmailConnected, setGmailConnected] = useState(null);\n\n  const loadGmailStatus = async () => {\n    try {\n      const res = await axios.get('/api/auth/gmail/status');\n      setGmailConnected(res.data?.connected ?? false);\n    } catch (_) {\n      setGmailConnected(false);\n    }\n  };\n\n  const loadContacts = async (searchValue = '') => {\n    const [recentRes, listRes] = await Promise.all([\n      axios.get('/api/contacts/recent', { params: { limit: 12 } }),\n      axios.get('/api/contacts', { params: { search: searchValue, limit: 150 } })\n    ]);\n\n    setRecentContacts(recentRes.data || []);\n    setContacts(listRes.data || []);\n  };\n\n  const loadContactDetails = async (contactId) => {\n    setLoadingDetails(true);\n    try {\n      const response = await axios.get(`/api/contacts/${contactId}`);\n      setSelectedContact(response.data || null);\n      setSelectedConversations(response.data?.conversations || []);\n    } catch (error) {\n      console.error('Error loading contact details:', error);\n      alert(error.response?.data?.error || 'Unable to load contact details right now');\n    } finally {\n      setLoadingDetails(false);\n    }\n  };\n\n  useEffect(() => {\n    let isMounted = true;\n    setLoading(true);\n    loadGmailStatus();\n    loadContacts(search)\n      .catch((error) => {\n        console.error('Error loading contacts:', error);\n        if (isMounted) alert(error.response?.data?.error || 'Unable to load contacts right now');\n      })\n      .finally(() => {\n        if (isMounted) setLoading(false);\n      });\n\n    return () => {\n      isMounted = false;\n    };\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [refreshToken]);\n\n  const searchCountLabel = useMemo(() => {\n    if (!search.trim()) return `${contacts.length} contacts`;\n    return `${contacts.length} results`;\n  }, [contacts.length, search]);\n\n  const handleSearch = async () => {\n    try {\n      setLoading(true);\n      await loadContacts(search);\n    } catch (error) {\n      console.error('Error searching contacts:', error);\n      alert(error.response?.data?.error || 'Unable to search contacts right now');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const scanGmailSuggestions = async () => {\n    setScanningSuggestions(true);\n    setScanWarning('');\n    try {\n      const response = await axios.post('/api/contacts/suggestions/from-live-gmail', {\n        scan_window_days: scanWindowDays,\n        max_messages: scanMaxMessages\n      });\n\n      const suggestions = response.data?.suggestions || [];\n      setGmailSuggestions(suggestions);\n      setSelectedSuggestionEmails(suggestions.map((item) => item.email).filter(Boolean));\n      setScanSource(response.data?.source || '');\n      setScanWarning(response.data?.warning || '');\n    } catch (error) {\n      console.error('Error scanning Gmail suggestions:', error);\n      alert(error.response?.data?.error || 'Unable to scan Gmail suggestions right now');\n    } finally {\n      setScanningSuggestions(false);\n    }\n  };\n\n  const toggleSuggestion = (email) => {\n    if (!email) return;\n    setSelectedSuggestionEmails((prev) => {\n      if (prev.includes(email)) return prev.filter((item) => item !== email);\n      return [...prev, email];\n    });\n  };\n\n  const applySelectedSuggestions = async () => {\n    const selected = gmailSuggestions.filter((item) => selectedSuggestionEmails.includes(item.email));\n    if (!selected.length) {\n      alert('Select at least one suggestion to apply.');\n      return;\n    }\n\n    setApplyingSuggestions(true);\n    try {\n      const response = await axios.post('/api/contacts/suggestions/apply', {\n        suggestions: selected\n      });\n      alert(`Suggestions applied. Created: ${response.data?.created_count || 0}, Updated: ${response.data?.updated_count || 0}`);\n      await loadContacts(search);\n      setGmailSuggestions([]);\n      setSelectedSuggestionEmails([]);\n    } catch (error) {\n      console.error('Error applying suggestions:', error);\n      alert(error.response?.data?.error || 'Unable to apply suggestions right now');\n    } finally {\n      setApplyingSuggestions(false);\n    }\n  };\n\n  const mergeRecentSummaries = async () => {\n    setMergingSummaries(true);\n    try {\n      const response = await axios.post('/api/contacts/merge-recent-summaries', { days: 30 });\n      alert(`Merged recent conversation summaries for ${response.data?.merged_count || 0} contact(s).`);\n      await loadContacts(search);\n      if (selectedContact?.id) {\n        await loadContactDetails(selectedContact.id);\n      }\n    } catch (error) {\n      console.error('Error merging recent summaries:', error);\n      alert(error.response?.data?.error || 'Unable to merge recent summaries right now');\n    } finally {\n      setMergingSummaries(false);\n    }\n  };\n\n  if (loading) {\n    return (\n      <div className=\"card\">\n        <h2>ðŸ‘¥ Contacts</h2>\n        <p>Loading contacts...</p>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"contacts-layout\">\n      <section className=\"card\">\n        <h2>ðŸ¤– Gmail Suggestions</h2>\n        <p className=\"section-subtext\">Scan Gmail with ChatGPT and review suggestions before adding or updating contacts.</p>\n\n        {gmailConnected === false && (\n          <div className=\"gmail-notice gmail-notice--warn\">\n            Gmail not connected. Go to <strong>Settings â†’ Gmail Account Connection</strong> to link your Google account before scanning.\n          </div>\n        )}\n\n        <div className=\"contacts-actions-row\">\n          <label>\n            Window (days)\n            <input\n              type=\"number\"\n              min={1}\n              max={365}\n              value={scanWindowDays}\n              onChange={(e) => setScanWindowDays(Math.max(parseInt(e.target.value, 10) || 1, 1))}\n            />\n          </label>\n          <label>\n            Max messages\n            <input\n              type=\"number\"\n              min={5}\n              max={100}\n              value={scanMaxMessages}\n              onChange={(e) => setScanMaxMessages(Math.max(Math.min(parseInt(e.target.value, 10) || 50, 100), 5))}\n            />\n          </label>\n          <button className=\"btn btn-primary btn-small\" type=\"button\" onClick={scanGmailSuggestions} disabled={scanningSuggestions || gmailConnected === false}>\n            {scanningSuggestions ? 'Scanning...' : 'Scan Gmail'}\n          </button>\n          <button className=\"btn btn-secondary btn-small\" type=\"button\" onClick={applySelectedSuggestions} disabled={applyingSuggestions || selectedSuggestionEmails.length === 0}>\n            {applyingSuggestions ? 'Applying...' : `Apply Selected (${selectedSuggestionEmails.length})`}\n          </button>\n          <button className=\"btn btn-secondary btn-small\" type=\"button\" onClick={mergeRecentSummaries} disabled={mergingSummaries}>\n            {mergingSummaries ? 'Merging...' : 'Merge Recent Summaries'}\n          </button>\n        </div>\n\n        {scanSource ? <p className=\"section-subtext\">Scan source: {scanSource}</p> : null}\n        {scanWarning ? <p className=\"error-text\">{scanWarning}</p> : null}\n\n        {gmailSuggestions.length > 0 ? (\n          <table className=\"data-table contacts-table\">\n            <thead>\n              <tr>\n                <th>Add</th>\n                <th>Name</th>\n                <th>Email</th>\n                <th>Action</th>\n                <th>Reason</th>\n                <th>Summary</th>\n              </tr>\n            </thead>\n            <tbody>\n              {gmailSuggestions.map((item) => (\n                <tr key={`${item.email}_${item.thread_id || ''}`}>\n                  <td>\n                    <input\n                      type=\"checkbox\"\n                      checked={selectedSuggestionEmails.includes(item.email)}\n                      onChange={() => toggleSuggestion(item.email)}\n                    />\n                  </td>\n                  <td>{item.full_name || '-'}</td>\n                  <td>{item.email || '-'}</td>\n                  <td>{item.action === 'update' ? `Update (${item.existing_contact_name || 'existing'})` : 'Create'}</td>\n                  <td>{item.reason || '-'}</td>\n                  <td>{item.conversation_summary || '-'}</td>\n                </tr>\n              ))}\n            </tbody>\n          </table>\n        ) : (\n          <p className=\"empty-state\">No suggestions loaded yet. Run a Gmail scan.</p>\n        )}\n      </section>\n\n      <section className=\"card\">\n        <h2>ðŸ•’ Recent Contacts</h2>\n        <p className=\"section-subtext\">Most recently touched contacts and their latest interaction context.</p>\n\n        {recentContacts.length > 0 ? (\n          <table className=\"data-table contacts-table\">\n            <thead>\n              <tr>\n                <th>Contact</th>\n                <th>Email</th>\n                <th>Last Interaction</th>\n                <th>Recent Context</th>\n              </tr>\n            </thead>\n            <tbody>\n              {recentContacts.map((contact) => {\n                const latest = (contact.recent_interactions || [])[0] || null;\n                return (\n                  <tr key={contact.id}>\n                    <td>{contact.full_name || '-'}</td>\n                    <td>{contact.email || '-'}</td>\n                    <td>{contact.last_conversation_at || contact.last_contacted_at || '-'}</td>\n                    <td>{latest?.summary || contact.conversation_summary || '-'}</td>\n                  </tr>\n                );\n              })}\n            </tbody>\n          </table>\n        ) : (\n          <p className=\"empty-state\">No recent contacts yet.</p>\n        )}\n      </section>\n\n      <section className=\"card\">\n        <div className=\"contacts-toolbar\">\n          <h2>All Contacts</h2>\n          <div className=\"contacts-search\">\n            <input\n              type=\"text\"\n              value={search}\n              onChange={(e) => setSearch(e.target.value)}\n              placeholder=\"Search name, email, company, notes\"\n              onKeyDown={(e) => {\n                if (e.key === 'Enter') handleSearch();\n              }}\n            />\n            <button className=\"btn btn-primary btn-small\" type=\"button\" onClick={handleSearch}>Search</button>\n          </div>\n        </div>\n        <p className=\"section-subtext\">{searchCountLabel}</p>\n\n        <div className=\"contacts-grid\">\n          <div className=\"contacts-list\">\n            {contacts.length > 0 ? (\n              <table className=\"data-table contacts-table\">\n                <thead>\n                  <tr>\n                    <th>Name</th>\n                    <th>Email</th>\n                    <th>Status</th>\n                    <th>Source</th>\n                    <th>Updated</th>\n                  </tr>\n                </thead>\n                <tbody>\n                  {contacts.map((contact) => (\n                    <tr key={contact.id} className={selectedContact?.id === contact.id ? 'row-selected' : ''}>\n                      <td>\n                        <button className=\"link-btn\" type=\"button\" onClick={() => loadContactDetails(contact.id)}>\n                          {contact.full_name || '(No name)'}\n                        </button>\n                      </td>\n                      <td>{contact.email || '-'}</td>\n                      <td>{contact.status || '-'}</td>\n                      <td>{contact.contact_source || '-'}</td>\n                      <td>{contact.updated_at || '-'}</td>\n                    </tr>\n                  ))}\n                </tbody>\n              </table>\n            ) : (\n              <p className=\"empty-state\">No contacts found.</p>\n            )}\n          </div>\n\n          <div className=\"contacts-details\">\n            <h3>Conversation Detail</h3>\n            {loadingDetails ? (\n              <p>Loading contact details...</p>\n            ) : selectedContact ? (\n              <>\n                <div className=\"contact-meta\">\n                  <div><strong>Name:</strong> {selectedContact.full_name || '-'}</div>\n                  <div><strong>Email:</strong> {selectedContact.email || '-'}</div>\n                  <div><strong>Status:</strong> {selectedContact.status || '-'}</div>\n                  <div><strong>Source:</strong> {selectedContact.contact_source || '-'}</div>\n                </div>\n\n                <div className=\"conversation-list\">\n                  {selectedConversations.length > 0 ? selectedConversations.map((item) => (\n                    <div key={item.id} className=\"conversation-item\">\n                      <div className=\"conversation-head\">\n                        <strong>{item.subject || 'No subject'}</strong>\n                        <span>{item.occurred_at || item.created_at || '-'}</span>\n                      </div>\n                      <p>{item.summary}</p>\n                    </div>\n                  )) : <p>No conversation history yet.</p>}\n                </div>\n              </>\n            ) : (\n              <p>Select a contact to view interaction history.</p>\n            )}\n          </div>\n        </div>\n      </section>\n    </div>\n  );\n}\n\nexport default Contacts;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}