{"ast":null,"code":"import _objectSpread from\"/home/rob/.openclaw/workspace/campsite-crm/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useEffect,useState}from'react';import axios from'axios';import'../styles/IntegrationHub.css';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const INITIAL_SETTINGS={chatgpt_enabled:false,workspace_name:'Campsite CRM',openai_api_key:'',openai_model:'gpt-4.1-mini',mcp_shared_secret:'',oauth_enabled:false,oauth_from_env:false,oauth_redirect_uri:'',gmail_scan_enabled:false,gmail_account_email:'',gmail_scan_window_days:45,mcp_url:'',oauth_redirect_default:'',openai_key_configured:false,mcp_secret_configured:false,oauth_client_secret_configured:false,gmail_token_configured:false,gmail_connected:false,gmail_refresh_token_configured:false};function IntegrationHub(_ref){var _dataOpsStatus$auto_s,_dataOpsStatus$auto_s2,_dataOpsStatus$auto_s3,_dataOpsStatus$totals,_dataOpsStatus$totals2,_dataOpsStatus$totals3,_dataOpsStatus$totals4,_dataOpsStatus$totals5,_dataOpsStatus$totals6,_dataOpsStatus$totals7,_dataOpsStatus$totals8,_dataOpsStatus$totals9,_dataOpsStatus$totals0,_dataOpsStatus$auto_s4,_dataOpsStatus$auto_s5;let{onRefreshData,onRefreshTasks,onRefreshContacts,onRefreshWaitlist}=_ref;const[settings,setSettings]=useState(INITIAL_SETTINGS);const[loading,setLoading]=useState(true);const[saving,setSaving]=useState(false);const[testing,setTesting]=useState(false);const[chatLoading,setChatLoading]=useState(false);const[chatInput,setChatInput]=useState('');const[includeContext,setIncludeContext]=useState(true);const[chatHistory,setChatHistory]=useState([]);const[scanningGmail,setScanningGmail]=useState(false);const[pendingScans,setPendingScans]=useState([]);const[approvingBatchId,setApprovingBatchId]=useState('');const[dataOpsStatus,setDataOpsStatus]=useState(null);const[dataOpsLoading,setDataOpsLoading]=useState(true);const[dataOpsAction,setDataOpsAction]=useState('');const[gmailStatus,setGmailStatus]=useState(null);const[connectingGmail,setConnectingGmail]=useState(false);const[disconnectingGmail,setDisconnectingGmail]=useState(false);const[gmailNotice,setGmailNotice]=useState('');const[showOpenAiModal,setShowOpenAiModal]=useState(false);const[modalApiKey,setModalApiKey]=useState('');const[savingKey,setSavingKey]=useState(false);const loadSettings=async()=>{setLoading(true);try{const response=await axios.get('/api/integrations/chatgpt/settings');setSettings(prev=>_objectSpread(_objectSpread({},prev),response.data));}catch(error){console.error('Error loading integration settings:',error);alert('Unable to load integration settings right now');}finally{setLoading(false);}};const loadGmailStatus=async()=>{try{const response=await axios.get('/api/auth/gmail/status');setGmailStatus(response.data||null);}catch(error){console.error('Error loading Gmail status:',error);}};const loadPendingScans=async()=>{try{const response=await axios.get('/api/integrations/chatgpt/gmail/scans/pending');setPendingScans(response.data||[]);}catch(error){console.error('Error loading pending scans:',error);}};const loadDataManagementStatus=async()=>{setDataOpsLoading(true);try{const response=await axios.get('/api/data-management/status');setDataOpsStatus(response.data||null);}catch(error){console.error('Error loading data management status:',error);setDataOpsStatus(null);}finally{setDataOpsLoading(false);}};useEffect(()=>{// Check if we just returned from Gmail OAuth\nconst params=new URLSearchParams(window.location.search);if(params.get('gmail_connected')==='1'){setGmailNotice('success');window.history.replaceState({},'',window.location.pathname);}else if(params.get('gmail_error')){setGmailNotice(\"error:\".concat(params.get('gmail_error')));window.history.replaceState({},'',window.location.pathname);}loadSettings();loadGmailStatus();loadPendingScans();loadDataManagementStatus();},[]);const saveSettings=async()=>{setSaving(true);try{await axios.put('/api/integrations/chatgpt/settings',{chatgpt_enabled:settings.chatgpt_enabled,workspace_name:settings.workspace_name,openai_api_key:settings.openai_api_key,openai_model:settings.openai_model,mcp_shared_secret:settings.mcp_shared_secret,oauth_enabled:settings.oauth_enabled,gmail_scan_window_days:settings.gmail_scan_window_days});await loadSettings();alert('Integration settings saved');}catch(error){var _error$response,_error$response$data;console.error('Error saving integration settings:',error);alert(((_error$response=error.response)===null||_error$response===void 0?void 0:(_error$response$data=_error$response.data)===null||_error$response$data===void 0?void 0:_error$response$data.error)||'Unable to save settings');}finally{setSaving(false);}};const connectGmail=async()=>{setConnectingGmail(true);try{const response=await axios.get('/api/auth/gmail/connect-url');window.location.href=response.data.url;}catch(error){var _error$response2,_error$response2$data;console.error('Error starting Gmail OAuth:',error);alert(((_error$response2=error.response)===null||_error$response2===void 0?void 0:(_error$response2$data=_error$response2.data)===null||_error$response2$data===void 0?void 0:_error$response2$data.error)||'Unable to start Gmail connection. Contact your administrator.');setConnectingGmail(false);}};const disconnectGmail=async()=>{if(!window.confirm('Disconnect Gmail? The stored tokens will be removed and email scanning will stop.'))return;setDisconnectingGmail(true);try{await axios.post('/api/auth/gmail/disconnect');await loadGmailStatus();await loadSettings();setGmailNotice('');}catch(error){var _error$response3,_error$response3$data;console.error('Error disconnecting Gmail:',error);alert(((_error$response3=error.response)===null||_error$response3===void 0?void 0:(_error$response3$data=_error$response3.data)===null||_error$response3$data===void 0?void 0:_error$response3$data.error)||'Unable to disconnect Gmail');}finally{setDisconnectingGmail(false);}};const connectOpenAI=async()=>{const key=modalApiKey.trim();if(!key)return;setSavingKey(true);try{await axios.put('/api/integrations/chatgpt/settings',{openai_api_key:key});setModalApiKey('');setShowOpenAiModal(false);await loadSettings();}catch(error){var _error$response4,_error$response4$data;alert(((_error$response4=error.response)===null||_error$response4===void 0?void 0:(_error$response4$data=_error$response4.data)===null||_error$response4$data===void 0?void 0:_error$response4$data.error)||'Unable to save API key');}finally{setSavingKey(false);}};const disconnectOpenAI=async()=>{if(!window.confirm('Disconnect ChatGPT? The stored API key will be removed.'))return;try{await axios.post('/api/integrations/chatgpt/disconnect-openai');await loadSettings();}catch(error){var _error$response5,_error$response5$data;alert(((_error$response5=error.response)===null||_error$response5===void 0?void 0:(_error$response5$data=_error$response5.data)===null||_error$response5$data===void 0?void 0:_error$response5$data.error)||'Unable to disconnect ChatGPT');}};const testConnection=async()=>{setTesting(true);try{const response=await axios.post('/api/integrations/chatgpt/test');alert(\"Connection OK (\".concat(response.data.model,\"): \").concat(response.data.preview||'No preview'));}catch(error){var _error$response6,_error$response6$data;console.error('Error testing ChatGPT connection:',error);alert(((_error$response6=error.response)===null||_error$response6===void 0?void 0:(_error$response6$data=_error$response6.data)===null||_error$response6$data===void 0?void 0:_error$response6$data.error)||'Connection test failed');}finally{setTesting(false);}};const askChatGpt=async()=>{const trimmed=chatInput.trim();if(!trimmed)return;const nextHistory=[...chatHistory,{role:'user',content:trimmed}];setChatHistory(nextHistory);setChatInput('');setChatLoading(true);try{const response=await axios.post('/api/chatgpt/chat',{message:trimmed,history:nextHistory,include_crm_context:includeContext});setChatHistory(prev=>[...prev,{role:'assistant',content:response.data.reply||''}]);if(onRefreshData)onRefreshData();if(onRefreshTasks)onRefreshTasks();}catch(error){console.error('Error querying chat endpoint:',error);setChatHistory(prev=>{var _error$response7,_error$response7$data;return[...prev,{role:'assistant',content:\"Error: \".concat(((_error$response7=error.response)===null||_error$response7===void 0?void 0:(_error$response7$data=_error$response7.data)===null||_error$response7$data===void 0?void 0:_error$response7$data.error)||'Unable to reach ChatGPT endpoint.')}];});}finally{setChatLoading(false);}};const scanGmail=async()=>{setScanningGmail(true);try{var _response$data;const response=await axios.post('/api/integrations/chatgpt/gmail/scan',{scan_window_days:settings.gmail_scan_window_days});const found=((_response$data=response.data)===null||_response$data===void 0?void 0:_response$data.total_found)||0;if(found>0){alert(\"Scan complete. Found \".concat(found,\" pending updates to review.\"));}else{alert('Scan complete. No new updates found.');}await loadPendingScans();}catch(error){var _error$response8,_error$response8$data;console.error('Error scanning Gmail:',error);alert(((_error$response8=error.response)===null||_error$response8===void 0?void 0:(_error$response8$data=_error$response8.data)===null||_error$response8$data===void 0?void 0:_error$response8$data.error)||'Failed to scan Gmail');}finally{setScanningGmail(false);}};const approveScan=async batchId=>{setApprovingBatchId(batchId);try{var _response$data2;const response=await axios.post(\"/api/integrations/chatgpt/gmail/scans/\".concat(batchId,\"/approve\"));alert(\"Approved. Applied \".concat(((_response$data2=response.data)===null||_response$data2===void 0?void 0:_response$data2.total_applied)||0,\" interactions.\"));await loadPendingScans();if(onRefreshContacts)onRefreshContacts();if(onRefreshData)onRefreshData();}catch(error){var _error$response9,_error$response9$data;console.error('Error approving scan:',error);alert(((_error$response9=error.response)===null||_error$response9===void 0?void 0:(_error$response9$data=_error$response9.data)===null||_error$response9$data===void 0?void 0:_error$response9$data.error)||'Failed to approve updates');}finally{setApprovingBatchId('');}};const runDataAction=async(actionKey,request)=>{setDataOpsAction(actionKey);try{const response=await request();await loadDataManagementStatus();if(onRefreshData)onRefreshData();if(onRefreshTasks)onRefreshTasks();if(onRefreshContacts)onRefreshContacts();if(onRefreshWaitlist)onRefreshWaitlist();return response;}finally{setDataOpsAction('');}};const saveAllDataNow=async()=>{try{var _response$data3;const response=await runDataAction('save',()=>axios.post('/api/data-management/save'));alert(\"Data snapshot saved: \".concat(((_response$data3=response.data)===null||_response$data3===void 0?void 0:_response$data3.backup_file)||'Saved'));}catch(error){var _error$response0,_error$response0$data,_error$response1,_error$response1$data;console.error('Error saving data snapshot:',error);alert(((_error$response0=error.response)===null||_error$response0===void 0?void 0:(_error$response0$data=_error$response0.data)===null||_error$response0$data===void 0?void 0:_error$response0$data.error)||((_error$response1=error.response)===null||_error$response1===void 0?void 0:(_error$response1$data=_error$response1.data)===null||_error$response1$data===void 0?void 0:_error$response1$data.message)||'Failed to save data snapshot');}};const populateDummyData=async()=>{if(!window.confirm('Populate all CRM sections with dummy demo data? Existing dummy rows will be replaced.'))return;try{await runDataAction('populate',()=>axios.post('/api/data-management/dummy/populate'));alert('Dummy data populated across bookings, contracts, waitlist, tasks, and contacts.');}catch(error){var _error$response10,_error$response10$dat;console.error('Error populating dummy data:',error);alert(((_error$response10=error.response)===null||_error$response10===void 0?void 0:(_error$response10$dat=_error$response10.data)===null||_error$response10$dat===void 0?void 0:_error$response10$dat.error)||'Failed to populate dummy data');}};const removeDummyData=async()=>{if(!window.confirm('Remove all dummy CRM data now? Real data will not be deleted.'))return;try{await runDataAction('remove',()=>axios.post('/api/data-management/dummy/remove'));alert('Dummy data removed.');}catch(error){var _error$response11,_error$response11$dat;console.error('Error removing dummy data:',error);alert(((_error$response11=error.response)===null||_error$response11===void 0?void 0:(_error$response11$dat=_error$response11.data)===null||_error$response11$dat===void 0?void 0:_error$response11$dat.error)||'Failed to remove dummy data');}};if(loading){return/*#__PURE__*/_jsxs(\"div\",{className:\"card\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"\\u2699\\uFE0F ChatGPT + MCP Settings\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Loading integration settings...\"})]});}return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"integration-grid\",children:[/*#__PURE__*/_jsxs(\"section\",{className:\"card\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"\\u2699\\uFE0F ChatGPT + MCP Settings\"}),/*#__PURE__*/_jsx(\"p\",{className:\"section-subtext\",children:\"Connect Campsite CRM to ChatGPT and enable Gmail interaction scanning.\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"integration-status-row\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"badge-pill\",children:[\"OpenAI Key: \",settings.openai_key_configured?'Configured':'Missing']}),/*#__PURE__*/_jsxs(\"div\",{className:\"badge-pill \".concat(settings.gmail_connected?'badge-pill--success':''),children:[\"Gmail: \",settings.gmail_connected?\"Connected\".concat(settings.gmail_account_email?\" \\u2014 \".concat(settings.gmail_account_email):''):'Not connected']}),/*#__PURE__*/_jsxs(\"div\",{className:\"badge-pill\",children:[\"MCP Secret: \",settings.mcp_secret_configured?'Configured':'Optional']})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"settings-grid\",children:[/*#__PURE__*/_jsxs(\"label\",{className:\"toggle-row\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:settings.chatgpt_enabled,onChange:e=>setSettings(_objectSpread(_objectSpread({},settings),{},{chatgpt_enabled:e.target.checked}))}),\"Enable ChatGPT Integration\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Workspace Name\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:settings.workspace_name,onChange:e=>setSettings(_objectSpread(_objectSpread({},settings),{},{workspace_name:e.target.value}))})]}),/*#__PURE__*/_jsx(\"div\",{className:\"openai-connect-block\",children:settings.openai_key_configured?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"span\",{className:\"gmail-status-dot gmail-status-dot--on\"}),/*#__PURE__*/_jsx(\"strong\",{children:\"ChatGPT connected\"}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-secondary btn-small\",type:\"button\",onClick:disconnectOpenAI,children:\"Disconnect\"})]}):/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-primary\",type:\"button\",onClick:()=>setShowOpenAiModal(true),children:\"Connect ChatGPT\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Gmail Scan Window (days)\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",min:\"1\",value:settings.gmail_scan_window_days,onChange:e=>setSettings(_objectSpread(_objectSpread({},settings),{},{gmail_scan_window_days:parseInt(e.target.value,10)||1}))})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"MCP Shared Secret (Bearer token)\"}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",value:settings.mcp_shared_secret,onChange:e=>setSettings(_objectSpread(_objectSpread({},settings),{},{mcp_shared_secret:e.target.value})),placeholder:\"Optional but recommended\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-actions\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-primary\",type:\"button\",onClick:saveSettings,disabled:saving,children:saving?'Saving...':'Save Settings'}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-secondary\",type:\"button\",onClick:testConnection,disabled:testing,children:testing?'Testing...':'Test OpenAI Connection'})]})]}),/*#__PURE__*/_jsxs(\"section\",{className:\"card\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"\\uD83D\\uDCE7 Gmail Account Connection\"}),/*#__PURE__*/_jsx(\"p\",{className:\"section-subtext\",children:\"Connect your Gmail account via OAuth to allow the CRM to scan emails for guest contacts and conversation history.\"}),gmailNotice==='success'&&/*#__PURE__*/_jsx(\"div\",{className:\"gmail-notice gmail-notice--success\",children:\"Gmail connected successfully! Email scanning is now enabled.\"}),gmailNotice.startsWith('error:')&&/*#__PURE__*/_jsxs(\"div\",{className:\"gmail-notice gmail-notice--error\",children:[\"Gmail connection failed: \",gmailNotice.replace('error:','')]}),gmailStatus?gmailStatus.connected?/*#__PURE__*/_jsxs(\"div\",{className:\"gmail-connected-block\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"gmail-connected-info\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"gmail-status-dot gmail-status-dot--on\"}),/*#__PURE__*/_jsx(\"strong\",{children:\"Connected\"}),gmailStatus.account_email?/*#__PURE__*/_jsxs(\"span\",{children:[\" as \",gmailStatus.account_email]}):null,gmailStatus.has_refresh_token?/*#__PURE__*/_jsx(\"span\",{className:\"badge-pill badge-pill--success\",children:\"Auto-refresh enabled\"}):null]}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-secondary\",type:\"button\",onClick:disconnectGmail,disabled:disconnectingGmail,children:disconnectingGmail?'Disconnecting...':'Disconnect Gmail'})]}):/*#__PURE__*/_jsxs(\"div\",{className:\"gmail-connect-block\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"gmail-connected-info\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"gmail-status-dot gmail-status-dot--off\"}),/*#__PURE__*/_jsx(\"strong\",{children:\"Not connected\"})]}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-primary\",type:\"button\",onClick:connectGmail,disabled:connectingGmail,children:connectingGmail?'Redirecting to Google...':'Connect Gmail Account'})]}):/*#__PURE__*/_jsx(\"p\",{className:\"chat-empty\",children:\"Loading Gmail status...\"})]}),/*#__PURE__*/_jsxs(\"section\",{className:\"card\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"\\uD83D\\uDDC2\\uFE0F Data Management\"}),/*#__PURE__*/_jsx(\"p\",{className:\"section-subtext\",children:\"Auto-save snapshots run in the backend on a timer. Use these controls to save now and add/remove full dummy CRM data.\"}),dataOpsLoading?/*#__PURE__*/_jsx(\"p\",{className:\"chat-empty\",children:\"Loading data management status...\"}):/*#__PURE__*/_jsxs(\"div\",{className:\"data-status-grid\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"badge-pill\",children:[\"Auto-save every: \",(dataOpsStatus===null||dataOpsStatus===void 0?void 0:(_dataOpsStatus$auto_s=dataOpsStatus.auto_save)===null||_dataOpsStatus$auto_s===void 0?void 0:_dataOpsStatus$auto_s.interval_minutes)||'-',\" min\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"badge-pill\",children:[\"Last save: \",(dataOpsStatus===null||dataOpsStatus===void 0?void 0:(_dataOpsStatus$auto_s2=dataOpsStatus.auto_save)===null||_dataOpsStatus$auto_s2===void 0?void 0:_dataOpsStatus$auto_s2.last_save_at)||'Not yet']}),/*#__PURE__*/_jsxs(\"div\",{className:\"badge-pill\",children:[\"Last mode: \",(dataOpsStatus===null||dataOpsStatus===void 0?void 0:(_dataOpsStatus$auto_s3=dataOpsStatus.auto_save)===null||_dataOpsStatus$auto_s3===void 0?void 0:_dataOpsStatus$auto_s3.last_save_type)||'-']}),/*#__PURE__*/_jsxs(\"div\",{className:\"badge-pill\",children:[\"Bookings: \",(_dataOpsStatus$totals=dataOpsStatus===null||dataOpsStatus===void 0?void 0:(_dataOpsStatus$totals2=dataOpsStatus.totals)===null||_dataOpsStatus$totals2===void 0?void 0:_dataOpsStatus$totals2.bookings)!==null&&_dataOpsStatus$totals!==void 0?_dataOpsStatus$totals:0]}),/*#__PURE__*/_jsxs(\"div\",{className:\"badge-pill\",children:[\"Contracts: \",(_dataOpsStatus$totals3=dataOpsStatus===null||dataOpsStatus===void 0?void 0:(_dataOpsStatus$totals4=dataOpsStatus.totals)===null||_dataOpsStatus$totals4===void 0?void 0:_dataOpsStatus$totals4.contracts)!==null&&_dataOpsStatus$totals3!==void 0?_dataOpsStatus$totals3:0]}),/*#__PURE__*/_jsxs(\"div\",{className:\"badge-pill\",children:[\"Waitlist: \",(_dataOpsStatus$totals5=dataOpsStatus===null||dataOpsStatus===void 0?void 0:(_dataOpsStatus$totals6=dataOpsStatus.totals)===null||_dataOpsStatus$totals6===void 0?void 0:_dataOpsStatus$totals6.waitlist_entries)!==null&&_dataOpsStatus$totals5!==void 0?_dataOpsStatus$totals5:0]}),/*#__PURE__*/_jsxs(\"div\",{className:\"badge-pill\",children:[\"Tasks: \",(_dataOpsStatus$totals7=dataOpsStatus===null||dataOpsStatus===void 0?void 0:(_dataOpsStatus$totals8=dataOpsStatus.totals)===null||_dataOpsStatus$totals8===void 0?void 0:_dataOpsStatus$totals8.tasks)!==null&&_dataOpsStatus$totals7!==void 0?_dataOpsStatus$totals7:0]}),/*#__PURE__*/_jsxs(\"div\",{className:\"badge-pill\",children:[\"Contacts: \",(_dataOpsStatus$totals9=dataOpsStatus===null||dataOpsStatus===void 0?void 0:(_dataOpsStatus$totals0=dataOpsStatus.totals)===null||_dataOpsStatus$totals0===void 0?void 0:_dataOpsStatus$totals0.contacts)!==null&&_dataOpsStatus$totals9!==void 0?_dataOpsStatus$totals9:0]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-actions\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-primary\",type:\"button\",onClick:saveAllDataNow,disabled:dataOpsAction!=='',children:dataOpsAction==='save'?'Saving...':'Save All Data Now'}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-secondary\",type:\"button\",onClick:populateDummyData,disabled:dataOpsAction!=='',children:dataOpsAction==='populate'?'Populating...':'Populate Dummy Data'}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-secondary\",type:\"button\",onClick:removeDummyData,disabled:dataOpsAction!=='',children:dataOpsAction==='remove'?'Removing...':'Remove Dummy Data'}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-secondary\",type:\"button\",onClick:loadDataManagementStatus,disabled:dataOpsAction!=='',children:\"Refresh Status\"})]}),dataOpsStatus!==null&&dataOpsStatus!==void 0&&(_dataOpsStatus$auto_s4=dataOpsStatus.auto_save)!==null&&_dataOpsStatus$auto_s4!==void 0&&_dataOpsStatus$auto_s4.last_save_path?/*#__PURE__*/_jsxs(\"p\",{className:\"section-subtext data-save-path\",children:[\"Latest backup: \",dataOpsStatus.auto_save.last_save_path]}):null,dataOpsStatus!==null&&dataOpsStatus!==void 0&&(_dataOpsStatus$auto_s5=dataOpsStatus.auto_save)!==null&&_dataOpsStatus$auto_s5!==void 0&&_dataOpsStatus$auto_s5.last_error?/*#__PURE__*/_jsxs(\"p\",{className:\"section-subtext data-save-error\",children:[\"Last auto-save error: \",dataOpsStatus.auto_save.last_error]}):null]}),/*#__PURE__*/_jsxs(\"section\",{className:\"card\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"\\uD83D\\uDCEC Gmail Interaction Scan\"}),/*#__PURE__*/_jsx(\"p\",{className:\"section-subtext\",children:\"Scan recent Gmail messages, review pending interaction updates, then approve before applying to contacts.\"}),/*#__PURE__*/_jsx(\"div\",{className:\"form-actions\",children:/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-primary\",type:\"button\",onClick:scanGmail,disabled:scanningGmail,children:scanningGmail?'Scanning...':'Scan Gmail for Recent Interactions'})}),/*#__PURE__*/_jsx(\"div\",{className:\"scan-list\",children:pendingScans.length>0?pendingScans.map(batch=>{var _batch$items;return/*#__PURE__*/_jsxs(\"div\",{className:\"scan-card\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"scan-card-head\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"strong\",{children:[\"Batch \",batch.id.slice(0,8)]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Found \",batch.total_found,\" updates on \",batch.created_at]})]}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-secondary btn-small\",type:\"button\",onClick:()=>approveScan(batch.id),disabled:approvingBatchId===batch.id,children:approvingBatchId===batch.id?'Approving...':'Approve Updates'})]}),/*#__PURE__*/_jsx(\"div\",{className:\"scan-items\",children:((_batch$items=batch.items)===null||_batch$items===void 0?void 0:_batch$items.length)>0?batch.items.map(item=>/*#__PURE__*/_jsxs(\"div\",{className:\"scan-item\",children:[/*#__PURE__*/_jsx(\"strong\",{children:item.full_name||item.email}),/*#__PURE__*/_jsxs(\"span\",{children:[item.occurred_at||'-',\" \",item.direction?\"(\".concat(item.direction,\")\"):'']}),/*#__PURE__*/_jsx(\"p\",{children:item.summary})]},item.id)):/*#__PURE__*/_jsx(\"p\",{className:\"chat-empty\",children:\"No item preview available.\"})})]},batch.id);}):/*#__PURE__*/_jsx(\"p\",{className:\"chat-empty\",children:\"No pending scan updates right now.\"})})]}),/*#__PURE__*/_jsxs(\"section\",{className:\"card\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"\\uD83E\\uDDED Setup Instructions\"}),/*#__PURE__*/_jsxs(\"ol\",{className:\"instructions-list\",children:[/*#__PURE__*/_jsx(\"li\",{children:\"Optionally add an OpenAI API key and enable ChatGPT integration for AI-powered email analysis.\"}),/*#__PURE__*/_jsxs(\"li\",{children:[\"Click \",/*#__PURE__*/_jsx(\"strong\",{children:\"Connect Gmail Account\"}),\" in the Gmail Connection section and approve access in your browser.\"]}),/*#__PURE__*/_jsxs(\"li\",{children:[\"Once connected, go to the \",/*#__PURE__*/_jsx(\"strong\",{children:\"Contacts\"}),\" tab and run a Gmail scan. Review suggestions and apply the ones you want.\"]}),/*#__PURE__*/_jsx(\"li\",{children:\"Use the MCP endpoint URL below in your MCP client or ChatGPT bridge.\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"instruction-code\",children:[/*#__PURE__*/_jsx(\"strong\",{children:\"MCP URL\"}),/*#__PURE__*/_jsx(\"code\",{children:settings.mcp_url||'-'})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"instruction-code\",children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Quick MCP initialize example\"}),/*#__PURE__*/_jsx(\"code\",{children:\"curl -X POST \".concat(settings.mcp_url||'http://localhost:5000/mcp',\" -H \\\"Content-Type: application/json\\\" -d '{\\\"jsonrpc\\\":\\\"2.0\\\",\\\"id\\\":1,\\\"method\\\":\\\"initialize\\\",\\\"params\\\":{}}'\")})]})]}),/*#__PURE__*/_jsxs(\"section\",{className:\"card integration-chat-card\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"\\uD83D\\uDCAC Ask ChatGPT Inside CRM\"}),/*#__PURE__*/_jsx(\"p\",{className:\"section-subtext\",children:\"This chat can include live CRM context (bookings, waitlist, tasks, summary).\"}),/*#__PURE__*/_jsxs(\"label\",{className:\"toggle-row\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:includeContext,onChange:e=>setIncludeContext(e.target.checked)}),\"Include live CRM context in prompts\"]}),/*#__PURE__*/_jsx(\"div\",{className:\"chat-log\",children:chatHistory.length>0?chatHistory.map((msg,index)=>/*#__PURE__*/_jsxs(\"div\",{className:\"chat-msg \".concat(msg.role),children:[/*#__PURE__*/_jsx(\"strong\",{children:msg.role==='assistant'?'ChatGPT':'You'}),/*#__PURE__*/_jsx(\"p\",{children:msg.content})]},\"\".concat(msg.role,\"-\").concat(index))):/*#__PURE__*/_jsx(\"p\",{className:\"chat-empty\",children:\"No chat yet. Ask about bookings, occupancy, overdue balances, or task planning.\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"chat-input-row\",children:[/*#__PURE__*/_jsx(\"textarea\",{value:chatInput,onChange:e=>setChatInput(e.target.value),placeholder:\"Example: What tasks should we prioritize this week based on overdue bookings and upcoming arrivals?\"}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-primary\",type:\"button\",onClick:askChatGpt,disabled:chatLoading,children:chatLoading?'Thinking...':'Ask ChatGPT'})]})]})]}),showOpenAiModal&&/*#__PURE__*/_jsx(\"div\",{className:\"modal-overlay\",onClick:()=>setShowOpenAiModal(false),children:/*#__PURE__*/_jsxs(\"div\",{className:\"modal-box\",onClick:e=>e.stopPropagation(),children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Connect ChatGPT\"}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Get your API key at\",' ',/*#__PURE__*/_jsx(\"a\",{href:\"https://platform.openai.com/api-keys\",target:\"_blank\",rel:\"noopener noreferrer\",children:\"platform.openai.com/api-keys\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"form-group\",children:/*#__PURE__*/_jsx(\"input\",{type:\"password\",value:modalApiKey,onChange:e=>setModalApiKey(e.target.value),placeholder:\"sk-...\",autoFocus:true})}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-actions\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-primary\",type:\"button\",onClick:connectOpenAI,disabled:savingKey||!modalApiKey.trim(),children:savingKey?'Connecting...':'Connect'}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-secondary\",type:\"button\",onClick:()=>setShowOpenAiModal(false),children:\"Cancel\"})]})]})})]});}export default IntegrationHub;","map":{"version":3,"names":["React","useEffect","useState","axios","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","INITIAL_SETTINGS","chatgpt_enabled","workspace_name","openai_api_key","openai_model","mcp_shared_secret","oauth_enabled","oauth_from_env","oauth_redirect_uri","gmail_scan_enabled","gmail_account_email","gmail_scan_window_days","mcp_url","oauth_redirect_default","openai_key_configured","mcp_secret_configured","oauth_client_secret_configured","gmail_token_configured","gmail_connected","gmail_refresh_token_configured","IntegrationHub","_ref","_dataOpsStatus$auto_s","_dataOpsStatus$auto_s2","_dataOpsStatus$auto_s3","_dataOpsStatus$totals","_dataOpsStatus$totals2","_dataOpsStatus$totals3","_dataOpsStatus$totals4","_dataOpsStatus$totals5","_dataOpsStatus$totals6","_dataOpsStatus$totals7","_dataOpsStatus$totals8","_dataOpsStatus$totals9","_dataOpsStatus$totals0","_dataOpsStatus$auto_s4","_dataOpsStatus$auto_s5","onRefreshData","onRefreshTasks","onRefreshContacts","onRefreshWaitlist","settings","setSettings","loading","setLoading","saving","setSaving","testing","setTesting","chatLoading","setChatLoading","chatInput","setChatInput","includeContext","setIncludeContext","chatHistory","setChatHistory","scanningGmail","setScanningGmail","pendingScans","setPendingScans","approvingBatchId","setApprovingBatchId","dataOpsStatus","setDataOpsStatus","dataOpsLoading","setDataOpsLoading","dataOpsAction","setDataOpsAction","gmailStatus","setGmailStatus","connectingGmail","setConnectingGmail","disconnectingGmail","setDisconnectingGmail","gmailNotice","setGmailNotice","showOpenAiModal","setShowOpenAiModal","modalApiKey","setModalApiKey","savingKey","setSavingKey","loadSettings","response","get","prev","_objectSpread","data","error","console","alert","loadGmailStatus","loadPendingScans","loadDataManagementStatus","params","URLSearchParams","window","location","search","history","replaceState","pathname","concat","saveSettings","put","_error$response","_error$response$data","connectGmail","href","url","_error$response2","_error$response2$data","disconnectGmail","confirm","post","_error$response3","_error$response3$data","connectOpenAI","key","trim","_error$response4","_error$response4$data","disconnectOpenAI","_error$response5","_error$response5$data","testConnection","model","preview","_error$response6","_error$response6$data","askChatGpt","trimmed","nextHistory","role","content","message","include_crm_context","reply","_error$response7","_error$response7$data","scanGmail","_response$data","scan_window_days","found","total_found","_error$response8","_error$response8$data","approveScan","batchId","_response$data2","total_applied","_error$response9","_error$response9$data","runDataAction","actionKey","request","saveAllDataNow","_response$data3","backup_file","_error$response0","_error$response0$data","_error$response1","_error$response1$data","populateDummyData","_error$response10","_error$response10$dat","removeDummyData","_error$response11","_error$response11$dat","className","children","type","checked","onChange","e","target","value","onClick","min","parseInt","placeholder","disabled","startsWith","replace","connected","account_email","has_refresh_token","auto_save","interval_minutes","last_save_at","last_save_type","totals","bookings","contracts","waitlist_entries","tasks","contacts","last_save_path","last_error","length","map","batch","_batch$items","id","slice","created_at","items","item","full_name","email","occurred_at","direction","summary","msg","index","stopPropagation","rel","autoFocus"],"sources":["/home/rob/.openclaw/workspace/campsite-crm/frontend/src/components/IntegrationHub.jsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport axios from 'axios';\nimport '../styles/IntegrationHub.css';\n\nconst INITIAL_SETTINGS = {\n  chatgpt_enabled: false,\n  workspace_name: 'Campsite CRM',\n  openai_api_key: '',\n  openai_model: 'gpt-4.1-mini',\n  mcp_shared_secret: '',\n  oauth_enabled: false,\n  oauth_from_env: false,\n  oauth_redirect_uri: '',\n  gmail_scan_enabled: false,\n  gmail_account_email: '',\n  gmail_scan_window_days: 45,\n  mcp_url: '',\n  oauth_redirect_default: '',\n  openai_key_configured: false,\n  mcp_secret_configured: false,\n  oauth_client_secret_configured: false,\n  gmail_token_configured: false,\n  gmail_connected: false,\n  gmail_refresh_token_configured: false\n};\n\nfunction IntegrationHub({ onRefreshData, onRefreshTasks, onRefreshContacts, onRefreshWaitlist }) {\n  const [settings, setSettings] = useState(INITIAL_SETTINGS);\n  const [loading, setLoading] = useState(true);\n  const [saving, setSaving] = useState(false);\n  const [testing, setTesting] = useState(false);\n  const [chatLoading, setChatLoading] = useState(false);\n  const [chatInput, setChatInput] = useState('');\n  const [includeContext, setIncludeContext] = useState(true);\n  const [chatHistory, setChatHistory] = useState([]);\n  const [scanningGmail, setScanningGmail] = useState(false);\n  const [pendingScans, setPendingScans] = useState([]);\n  const [approvingBatchId, setApprovingBatchId] = useState('');\n  const [dataOpsStatus, setDataOpsStatus] = useState(null);\n  const [dataOpsLoading, setDataOpsLoading] = useState(true);\n  const [dataOpsAction, setDataOpsAction] = useState('');\n  const [gmailStatus, setGmailStatus] = useState(null);\n  const [connectingGmail, setConnectingGmail] = useState(false);\n  const [disconnectingGmail, setDisconnectingGmail] = useState(false);\n  const [gmailNotice, setGmailNotice] = useState('');\n  const [showOpenAiModal, setShowOpenAiModal] = useState(false);\n  const [modalApiKey, setModalApiKey] = useState('');\n  const [savingKey, setSavingKey] = useState(false);\n\n  const loadSettings = async () => {\n    setLoading(true);\n    try {\n      const response = await axios.get('/api/integrations/chatgpt/settings');\n      setSettings((prev) => ({ ...prev, ...response.data }));\n    } catch (error) {\n      console.error('Error loading integration settings:', error);\n      alert('Unable to load integration settings right now');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const loadGmailStatus = async () => {\n    try {\n      const response = await axios.get('/api/auth/gmail/status');\n      setGmailStatus(response.data || null);\n    } catch (error) {\n      console.error('Error loading Gmail status:', error);\n    }\n  };\n\n  const loadPendingScans = async () => {\n    try {\n      const response = await axios.get('/api/integrations/chatgpt/gmail/scans/pending');\n      setPendingScans(response.data || []);\n    } catch (error) {\n      console.error('Error loading pending scans:', error);\n    }\n  };\n\n  const loadDataManagementStatus = async () => {\n    setDataOpsLoading(true);\n    try {\n      const response = await axios.get('/api/data-management/status');\n      setDataOpsStatus(response.data || null);\n    } catch (error) {\n      console.error('Error loading data management status:', error);\n      setDataOpsStatus(null);\n    } finally {\n      setDataOpsLoading(false);\n    }\n  };\n\n  useEffect(() => {\n    // Check if we just returned from Gmail OAuth\n    const params = new URLSearchParams(window.location.search);\n    if (params.get('gmail_connected') === '1') {\n      setGmailNotice('success');\n      window.history.replaceState({}, '', window.location.pathname);\n    } else if (params.get('gmail_error')) {\n      setGmailNotice(`error:${params.get('gmail_error')}`);\n      window.history.replaceState({}, '', window.location.pathname);\n    }\n    loadSettings();\n    loadGmailStatus();\n    loadPendingScans();\n    loadDataManagementStatus();\n  }, []);\n\n  const saveSettings = async () => {\n    setSaving(true);\n    try {\n      await axios.put('/api/integrations/chatgpt/settings', {\n        chatgpt_enabled: settings.chatgpt_enabled,\n        workspace_name: settings.workspace_name,\n        openai_api_key: settings.openai_api_key,\n        openai_model: settings.openai_model,\n        mcp_shared_secret: settings.mcp_shared_secret,\n        oauth_enabled: settings.oauth_enabled,\n        gmail_scan_window_days: settings.gmail_scan_window_days\n      });\n      await loadSettings();\n      alert('Integration settings saved');\n    } catch (error) {\n      console.error('Error saving integration settings:', error);\n      alert(error.response?.data?.error || 'Unable to save settings');\n    } finally {\n      setSaving(false);\n    }\n  };\n\n  const connectGmail = async () => {\n    setConnectingGmail(true);\n    try {\n      const response = await axios.get('/api/auth/gmail/connect-url');\n      window.location.href = response.data.url;\n    } catch (error) {\n      console.error('Error starting Gmail OAuth:', error);\n      alert(error.response?.data?.error || 'Unable to start Gmail connection. Contact your administrator.');\n      setConnectingGmail(false);\n    }\n  };\n\n  const disconnectGmail = async () => {\n    if (!window.confirm('Disconnect Gmail? The stored tokens will be removed and email scanning will stop.')) return;\n    setDisconnectingGmail(true);\n    try {\n      await axios.post('/api/auth/gmail/disconnect');\n      await loadGmailStatus();\n      await loadSettings();\n      setGmailNotice('');\n    } catch (error) {\n      console.error('Error disconnecting Gmail:', error);\n      alert(error.response?.data?.error || 'Unable to disconnect Gmail');\n    } finally {\n      setDisconnectingGmail(false);\n    }\n  };\n\n  const connectOpenAI = async () => {\n    const key = modalApiKey.trim();\n    if (!key) return;\n    setSavingKey(true);\n    try {\n      await axios.put('/api/integrations/chatgpt/settings', { openai_api_key: key });\n      setModalApiKey('');\n      setShowOpenAiModal(false);\n      await loadSettings();\n    } catch (error) {\n      alert(error.response?.data?.error || 'Unable to save API key');\n    } finally {\n      setSavingKey(false);\n    }\n  };\n\n  const disconnectOpenAI = async () => {\n    if (!window.confirm('Disconnect ChatGPT? The stored API key will be removed.')) return;\n    try {\n      await axios.post('/api/integrations/chatgpt/disconnect-openai');\n      await loadSettings();\n    } catch (error) {\n      alert(error.response?.data?.error || 'Unable to disconnect ChatGPT');\n    }\n  };\n\n  const testConnection = async () => {\n    setTesting(true);\n    try {\n      const response = await axios.post('/api/integrations/chatgpt/test');\n      alert(`Connection OK (${response.data.model}): ${response.data.preview || 'No preview'}`);\n    } catch (error) {\n      console.error('Error testing ChatGPT connection:', error);\n      alert(error.response?.data?.error || 'Connection test failed');\n    } finally {\n      setTesting(false);\n    }\n  };\n\n  const askChatGpt = async () => {\n    const trimmed = chatInput.trim();\n    if (!trimmed) return;\n\n    const nextHistory = [...chatHistory, { role: 'user', content: trimmed }];\n    setChatHistory(nextHistory);\n    setChatInput('');\n    setChatLoading(true);\n\n    try {\n      const response = await axios.post('/api/chatgpt/chat', {\n        message: trimmed,\n        history: nextHistory,\n        include_crm_context: includeContext\n      });\n\n      setChatHistory((prev) => [...prev, { role: 'assistant', content: response.data.reply || '' }]);\n\n      if (onRefreshData) onRefreshData();\n      if (onRefreshTasks) onRefreshTasks();\n    } catch (error) {\n      console.error('Error querying chat endpoint:', error);\n      setChatHistory((prev) => [\n        ...prev,\n        { role: 'assistant', content: `Error: ${error.response?.data?.error || 'Unable to reach ChatGPT endpoint.'}` }\n      ]);\n    } finally {\n      setChatLoading(false);\n    }\n  };\n\n  const scanGmail = async () => {\n    setScanningGmail(true);\n    try {\n      const response = await axios.post('/api/integrations/chatgpt/gmail/scan', {\n        scan_window_days: settings.gmail_scan_window_days\n      });\n\n      const found = response.data?.total_found || 0;\n      if (found > 0) {\n        alert(`Scan complete. Found ${found} pending updates to review.`);\n      } else {\n        alert('Scan complete. No new updates found.');\n      }\n\n      await loadPendingScans();\n    } catch (error) {\n      console.error('Error scanning Gmail:', error);\n      alert(error.response?.data?.error || 'Failed to scan Gmail');\n    } finally {\n      setScanningGmail(false);\n    }\n  };\n\n  const approveScan = async (batchId) => {\n    setApprovingBatchId(batchId);\n    try {\n      const response = await axios.post(`/api/integrations/chatgpt/gmail/scans/${batchId}/approve`);\n      alert(`Approved. Applied ${response.data?.total_applied || 0} interactions.`);\n      await loadPendingScans();\n      if (onRefreshContacts) onRefreshContacts();\n      if (onRefreshData) onRefreshData();\n    } catch (error) {\n      console.error('Error approving scan:', error);\n      alert(error.response?.data?.error || 'Failed to approve updates');\n    } finally {\n      setApprovingBatchId('');\n    }\n  };\n\n  const runDataAction = async (actionKey, request) => {\n    setDataOpsAction(actionKey);\n    try {\n      const response = await request();\n      await loadDataManagementStatus();\n      if (onRefreshData) onRefreshData();\n      if (onRefreshTasks) onRefreshTasks();\n      if (onRefreshContacts) onRefreshContacts();\n      if (onRefreshWaitlist) onRefreshWaitlist();\n      return response;\n    } finally {\n      setDataOpsAction('');\n    }\n  };\n\n  const saveAllDataNow = async () => {\n    try {\n      const response = await runDataAction('save', () => axios.post('/api/data-management/save'));\n      alert(`Data snapshot saved: ${response.data?.backup_file || 'Saved'}`);\n    } catch (error) {\n      console.error('Error saving data snapshot:', error);\n      alert(error.response?.data?.error || error.response?.data?.message || 'Failed to save data snapshot');\n    }\n  };\n\n  const populateDummyData = async () => {\n    if (!window.confirm('Populate all CRM sections with dummy demo data? Existing dummy rows will be replaced.')) return;\n    try {\n      await runDataAction('populate', () => axios.post('/api/data-management/dummy/populate'));\n      alert('Dummy data populated across bookings, contracts, waitlist, tasks, and contacts.');\n    } catch (error) {\n      console.error('Error populating dummy data:', error);\n      alert(error.response?.data?.error || 'Failed to populate dummy data');\n    }\n  };\n\n  const removeDummyData = async () => {\n    if (!window.confirm('Remove all dummy CRM data now? Real data will not be deleted.')) return;\n    try {\n      await runDataAction('remove', () => axios.post('/api/data-management/dummy/remove'));\n      alert('Dummy data removed.');\n    } catch (error) {\n      console.error('Error removing dummy data:', error);\n      alert(error.response?.data?.error || 'Failed to remove dummy data');\n    }\n  };\n\n  if (loading) {\n    return (\n      <div className=\"card\">\n        <h2>‚öôÔ∏è ChatGPT + MCP Settings</h2>\n        <p>Loading integration settings...</p>\n      </div>\n    );\n  }\n\n  return (\n    <>\n    <div className=\"integration-grid\">\n      <section className=\"card\">\n        <h2>‚öôÔ∏è ChatGPT + MCP Settings</h2>\n        <p className=\"section-subtext\">Connect Campsite CRM to ChatGPT and enable Gmail interaction scanning.</p>\n\n        <div className=\"integration-status-row\">\n          <div className=\"badge-pill\">OpenAI Key: {settings.openai_key_configured ? 'Configured' : 'Missing'}</div>\n          <div className={`badge-pill ${settings.gmail_connected ? 'badge-pill--success' : ''}`}>\n            Gmail: {settings.gmail_connected ? `Connected${settings.gmail_account_email ? ` ‚Äî ${settings.gmail_account_email}` : ''}` : 'Not connected'}\n          </div>\n          <div className=\"badge-pill\">MCP Secret: {settings.mcp_secret_configured ? 'Configured' : 'Optional'}</div>\n        </div>\n\n        <div className=\"settings-grid\">\n          <label className=\"toggle-row\">\n            <input\n              type=\"checkbox\"\n              checked={settings.chatgpt_enabled}\n              onChange={(e) => setSettings({ ...settings, chatgpt_enabled: e.target.checked })}\n            />\n            Enable ChatGPT Integration\n          </label>\n\n          <div className=\"form-group\">\n            <label>Workspace Name</label>\n            <input\n              type=\"text\"\n              value={settings.workspace_name}\n              onChange={(e) => setSettings({ ...settings, workspace_name: e.target.value })}\n            />\n          </div>\n\n          <div className=\"openai-connect-block\">\n            {settings.openai_key_configured ? (\n              <>\n                <span className=\"gmail-status-dot gmail-status-dot--on\" />\n                <strong>ChatGPT connected</strong>\n                <button className=\"btn btn-secondary btn-small\" type=\"button\" onClick={disconnectOpenAI}>\n                  Disconnect\n                </button>\n              </>\n            ) : (\n              <button className=\"btn btn-primary\" type=\"button\" onClick={() => setShowOpenAiModal(true)}>\n                Connect ChatGPT\n              </button>\n            )}\n          </div>\n\n          <div className=\"form-group\">\n            <label>Gmail Scan Window (days)</label>\n            <input\n              type=\"number\"\n              min=\"1\"\n              value={settings.gmail_scan_window_days}\n              onChange={(e) => setSettings({ ...settings, gmail_scan_window_days: parseInt(e.target.value, 10) || 1 })}\n            />\n          </div>\n\n          <div className=\"form-group\">\n            <label>MCP Shared Secret (Bearer token)</label>\n            <input\n              type=\"password\"\n              value={settings.mcp_shared_secret}\n              onChange={(e) => setSettings({ ...settings, mcp_shared_secret: e.target.value })}\n              placeholder=\"Optional but recommended\"\n            />\n          </div>\n\n        </div>\n\n        <div className=\"form-actions\">\n          <button className=\"btn btn-primary\" type=\"button\" onClick={saveSettings} disabled={saving}>\n            {saving ? 'Saving...' : 'Save Settings'}\n          </button>\n          <button className=\"btn btn-secondary\" type=\"button\" onClick={testConnection} disabled={testing}>\n            {testing ? 'Testing...' : 'Test OpenAI Connection'}\n          </button>\n        </div>\n      </section>\n\n      <section className=\"card\">\n        <h2>üìß Gmail Account Connection</h2>\n        <p className=\"section-subtext\">\n          Connect your Gmail account via OAuth to allow the CRM to scan emails for guest contacts and conversation history.\n        </p>\n\n        {gmailNotice === 'success' && (\n          <div className=\"gmail-notice gmail-notice--success\">\n            Gmail connected successfully! Email scanning is now enabled.\n          </div>\n        )}\n        {gmailNotice.startsWith('error:') && (\n          <div className=\"gmail-notice gmail-notice--error\">\n            Gmail connection failed: {gmailNotice.replace('error:', '')}\n          </div>\n        )}\n\n        {gmailStatus ? (\n          gmailStatus.connected ? (\n            <div className=\"gmail-connected-block\">\n              <div className=\"gmail-connected-info\">\n                <span className=\"gmail-status-dot gmail-status-dot--on\" />\n                <strong>Connected</strong>\n                {gmailStatus.account_email ? <span> as {gmailStatus.account_email}</span> : null}\n                {gmailStatus.has_refresh_token ? <span className=\"badge-pill badge-pill--success\">Auto-refresh enabled</span> : null}\n              </div>\n              <button\n                className=\"btn btn-secondary\"\n                type=\"button\"\n                onClick={disconnectGmail}\n                disabled={disconnectingGmail}\n              >\n                {disconnectingGmail ? 'Disconnecting...' : 'Disconnect Gmail'}\n              </button>\n            </div>\n          ) : (\n            <div className=\"gmail-connect-block\">\n              <div className=\"gmail-connected-info\">\n                <span className=\"gmail-status-dot gmail-status-dot--off\" />\n                <strong>Not connected</strong>\n              </div>\n              <button\n                className=\"btn btn-primary\"\n                type=\"button\"\n                onClick={connectGmail}\n                disabled={connectingGmail}\n              >\n                {connectingGmail ? 'Redirecting to Google...' : 'Connect Gmail Account'}\n              </button>\n            </div>\n          )\n        ) : (\n          <p className=\"chat-empty\">Loading Gmail status...</p>\n        )}\n      </section>\n\n      <section className=\"card\">\n        <h2>üóÇÔ∏è Data Management</h2>\n        <p className=\"section-subtext\">Auto-save snapshots run in the backend on a timer. Use these controls to save now and add/remove full dummy CRM data.</p>\n\n        {dataOpsLoading ? (\n          <p className=\"chat-empty\">Loading data management status...</p>\n        ) : (\n          <div className=\"data-status-grid\">\n            <div className=\"badge-pill\">Auto-save every: {dataOpsStatus?.auto_save?.interval_minutes || '-'} min</div>\n            <div className=\"badge-pill\">Last save: {dataOpsStatus?.auto_save?.last_save_at || 'Not yet'}</div>\n            <div className=\"badge-pill\">Last mode: {dataOpsStatus?.auto_save?.last_save_type || '-'}</div>\n            <div className=\"badge-pill\">Bookings: {dataOpsStatus?.totals?.bookings ?? 0}</div>\n            <div className=\"badge-pill\">Contracts: {dataOpsStatus?.totals?.contracts ?? 0}</div>\n            <div className=\"badge-pill\">Waitlist: {dataOpsStatus?.totals?.waitlist_entries ?? 0}</div>\n            <div className=\"badge-pill\">Tasks: {dataOpsStatus?.totals?.tasks ?? 0}</div>\n            <div className=\"badge-pill\">Contacts: {dataOpsStatus?.totals?.contacts ?? 0}</div>\n          </div>\n        )}\n\n        <div className=\"form-actions\">\n          <button className=\"btn btn-primary\" type=\"button\" onClick={saveAllDataNow} disabled={dataOpsAction !== ''}>\n            {dataOpsAction === 'save' ? 'Saving...' : 'Save All Data Now'}\n          </button>\n          <button className=\"btn btn-secondary\" type=\"button\" onClick={populateDummyData} disabled={dataOpsAction !== ''}>\n            {dataOpsAction === 'populate' ? 'Populating...' : 'Populate Dummy Data'}\n          </button>\n          <button className=\"btn btn-secondary\" type=\"button\" onClick={removeDummyData} disabled={dataOpsAction !== ''}>\n            {dataOpsAction === 'remove' ? 'Removing...' : 'Remove Dummy Data'}\n          </button>\n          <button className=\"btn btn-secondary\" type=\"button\" onClick={loadDataManagementStatus} disabled={dataOpsAction !== ''}>\n            Refresh Status\n          </button>\n        </div>\n\n        {dataOpsStatus?.auto_save?.last_save_path ? (\n          <p className=\"section-subtext data-save-path\">Latest backup: {dataOpsStatus.auto_save.last_save_path}</p>\n        ) : null}\n        {dataOpsStatus?.auto_save?.last_error ? (\n          <p className=\"section-subtext data-save-error\">Last auto-save error: {dataOpsStatus.auto_save.last_error}</p>\n        ) : null}\n      </section>\n\n      <section className=\"card\">\n        <h2>üì¨ Gmail Interaction Scan</h2>\n        <p className=\"section-subtext\">Scan recent Gmail messages, review pending interaction updates, then approve before applying to contacts.</p>\n\n        <div className=\"form-actions\">\n          <button className=\"btn btn-primary\" type=\"button\" onClick={scanGmail} disabled={scanningGmail}>\n            {scanningGmail ? 'Scanning...' : 'Scan Gmail for Recent Interactions'}\n          </button>\n        </div>\n\n        <div className=\"scan-list\">\n          {pendingScans.length > 0 ? pendingScans.map((batch) => (\n            <div key={batch.id} className=\"scan-card\">\n              <div className=\"scan-card-head\">\n                <div>\n                  <strong>Batch {batch.id.slice(0, 8)}</strong>\n                  <p>Found {batch.total_found} updates on {batch.created_at}</p>\n                </div>\n                <button\n                  className=\"btn btn-secondary btn-small\"\n                  type=\"button\"\n                  onClick={() => approveScan(batch.id)}\n                  disabled={approvingBatchId === batch.id}\n                >\n                  {approvingBatchId === batch.id ? 'Approving...' : 'Approve Updates'}\n                </button>\n              </div>\n              <div className=\"scan-items\">\n                {batch.items?.length > 0 ? batch.items.map((item) => (\n                  <div key={item.id} className=\"scan-item\">\n                    <strong>{item.full_name || item.email}</strong>\n                    <span>{item.occurred_at || '-'} {item.direction ? `(${item.direction})` : ''}</span>\n                    <p>{item.summary}</p>\n                  </div>\n                )) : <p className=\"chat-empty\">No item preview available.</p>}\n              </div>\n            </div>\n          )) : <p className=\"chat-empty\">No pending scan updates right now.</p>}\n        </div>\n      </section>\n\n      <section className=\"card\">\n        <h2>üß≠ Setup Instructions</h2>\n        <ol className=\"instructions-list\">\n          <li>Optionally add an OpenAI API key and enable ChatGPT integration for AI-powered email analysis.</li>\n          <li>Click <strong>Connect Gmail Account</strong> in the Gmail Connection section and approve access in your browser.</li>\n          <li>Once connected, go to the <strong>Contacts</strong> tab and run a Gmail scan. Review suggestions and apply the ones you want.</li>\n          <li>Use the MCP endpoint URL below in your MCP client or ChatGPT bridge.</li>\n        </ol>\n\n        <div className=\"instruction-code\">\n          <strong>MCP URL</strong>\n          <code>{settings.mcp_url || '-'}</code>\n        </div>\n\n        <div className=\"instruction-code\">\n          <strong>Quick MCP initialize example</strong>\n          <code>{`curl -X POST ${settings.mcp_url || 'http://localhost:5000/mcp'} -H \"Content-Type: application/json\" -d '{\"jsonrpc\":\"2.0\",\"id\":1,\"method\":\"initialize\",\"params\":{}}'`}</code>\n        </div>\n      </section>\n\n      <section className=\"card integration-chat-card\">\n        <h2>üí¨ Ask ChatGPT Inside CRM</h2>\n        <p className=\"section-subtext\">This chat can include live CRM context (bookings, waitlist, tasks, summary).</p>\n\n        <label className=\"toggle-row\">\n          <input\n            type=\"checkbox\"\n            checked={includeContext}\n            onChange={(e) => setIncludeContext(e.target.checked)}\n          />\n          Include live CRM context in prompts\n        </label>\n\n        <div className=\"chat-log\">\n          {chatHistory.length > 0 ? chatHistory.map((msg, index) => (\n            <div key={`${msg.role}-${index}`} className={`chat-msg ${msg.role}`}>\n              <strong>{msg.role === 'assistant' ? 'ChatGPT' : 'You'}</strong>\n              <p>{msg.content}</p>\n            </div>\n          )) : (\n            <p className=\"chat-empty\">No chat yet. Ask about bookings, occupancy, overdue balances, or task planning.</p>\n          )}\n        </div>\n\n        <div className=\"chat-input-row\">\n          <textarea\n            value={chatInput}\n            onChange={(e) => setChatInput(e.target.value)}\n            placeholder=\"Example: What tasks should we prioritize this week based on overdue bookings and upcoming arrivals?\"\n          />\n          <button className=\"btn btn-primary\" type=\"button\" onClick={askChatGpt} disabled={chatLoading}>\n            {chatLoading ? 'Thinking...' : 'Ask ChatGPT'}\n          </button>\n        </div>\n      </section>\n    </div>\n    {showOpenAiModal && (\n      <div className=\"modal-overlay\" onClick={() => setShowOpenAiModal(false)}>\n        <div className=\"modal-box\" onClick={(e) => e.stopPropagation()}>\n          <h3>Connect ChatGPT</h3>\n          <p>\n            Get your API key at{' '}\n            <a href=\"https://platform.openai.com/api-keys\" target=\"_blank\" rel=\"noopener noreferrer\">\n              platform.openai.com/api-keys\n            </a>\n          </p>\n          <div className=\"form-group\">\n            <input\n              type=\"password\"\n              value={modalApiKey}\n              onChange={(e) => setModalApiKey(e.target.value)}\n              placeholder=\"sk-...\"\n              autoFocus\n            />\n          </div>\n          <div className=\"form-actions\">\n            <button\n              className=\"btn btn-primary\"\n              type=\"button\"\n              onClick={connectOpenAI}\n              disabled={savingKey || !modalApiKey.trim()}\n            >\n              {savingKey ? 'Connecting...' : 'Connect'}\n            </button>\n            <button className=\"btn btn-secondary\" type=\"button\" onClick={() => setShowOpenAiModal(false)}>\n              Cancel\n            </button>\n          </div>\n        </div>\n      </div>\n    )}\n    </>\n  );\n}\n\nexport default IntegrationHub;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}